<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget Planner - Comprehensive Budget Tracking with Multi-Currency Support</title>
    <meta name="description" content="A comprehensive budget tracking application with multi-currency support, investment allocation, dynamic charts, and change history tracking. Plan your finances with real-time calculations and visual analytics.">
    <meta name="keywords" content="budget tracker, budget planner, personal finance, multi-currency, investment tracking, expense management, financial planning">
    <meta name="author" content="Budget Planner">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Budget Planner - Comprehensive Budget Tracking">
    <meta property="og:description" content="Track your budget with multi-currency support, investment allocation, and dynamic charts. Complete with change history and data import/export.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://bbogdanov.github.io/simple-budget/">
    <meta property="og:image" content="https://bbogdanov.github.io/simple-budget/preview.png">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Budget Planner - Comprehensive Budget Tracking">
    <meta name="twitter:description" content="Track your budget with multi-currency support, investment allocation, and dynamic charts.">
    <meta name="twitter:image" content="https://bbogdanov.github.io/simple-budget/preview.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üí∞</text></svg>">
    
    <link rel="stylesheet" href="styles.css">
    <!-- Chart.js library - can be replaced with local file -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Budget Planner</h1>
            <nav class="page-nav">
                <a href="/analytics/index.html" class="nav-btn">üìä CSV Analytics</a>
                <button type="button" class="nav-btn export-complete-btn" onclick="budgetTracker.exportCompleteData()" title="Export complete budget data with history as JSON">
                    üì• Export Complete Data
                </button>
                <button type="button" class="nav-btn help-btn" onclick="budgetTracker.showHelpPopup()" title="Show usage hints and tips">
                    ‚ùì Help & Tips
                </button>
            </nav>
        </header>

        <main>
            <!-- Annual Budget Section -->
            <section class="annual-budget full-width">
                <h2>Annual Budget Setup</h2>
                <div class="budget-setup-grid">
                    <div class="form-group">
                        <label for="currency">Currency:</label>
                        <select id="currency">
                            <option value="USD">USD ($)</option>
                            <option value="EUR">EUR (‚Ç¨)</option>
                            <option value="BGN">BGN (–ª–≤)</option>
                            <option value="GBP">GBP (¬£)</option>
                            <option value="JPY">JPY (¬•)</option>
                            <option value="CAD">CAD (C$)</option>
                            <option value="AUD">AUD (A$)</option>
                            <option value="CHF">CHF (Fr)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="maxCash">Max Available Cash Per Year (<span id="currencySymbol">$</span>):</label>
                        <input type="number" id="maxCash" placeholder="Enter your annual budget" min="0" step="0.01">
                    </div>
                </div>
                <div class="form-group">
                    <h3>üíπ Investment Allocation</h3>
                    <div class="investment-controls">
                        <div class="investment-type">
                            <label>Investment Type:</label>
                            <select id="investmentType">
                                <option value="amount">Fixed Amount ($)</option>
                                <option value="percentage">Percentage (%)</option>
                            </select>
                        </div>
                        <div class="investment-value">
                            <label for="investmentValue">Investment Value:</label>
                            <input type="number" id="investmentValue" placeholder="Enter amount or percentage" min="0" step="0.01">
                            <span class="investment-unit" id="investmentUnit">$</span>
                        </div>
                        <div class="investment-frequency">
                            <label for="investmentFrequency">Investment Frequency:</label>
                            <select id="investmentFrequency">
                                <option value="monthly" selected>Monthly</option>
                                <option value="quarterly">Quarterly</option>
                                <option value="yearly">Yearly</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="import-section">
                    <h3>Import Budget Data</h3>
                    <p>Select a feed.json file to instantly import and populate your budget items and settings.</p>
                    
                    <div class="import-group">
                        <label for="feedFile">Select feed.json file:</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="feedFile" accept="application/json,.json" onchange="budgetTracker.handleFeedImport()">
                        </div>
                        <span id="importStatus" class="import-status"></span>
                    </div>
                    

                    
                    <details class="json-format-help">
                        <summary>Expected JSON Format</summary>
                        <pre><code>{
  "settings": {
    "maxCash": 100000,
    "currency": "USD",
    "investment": {
      "type": "percentage",
      "value": 10,
      "frequency": "yearly"
    }
  },
  "items": [
    {
      "name": "rent",
      "value": 1200,
      "frequency": "monthly",
      "tags": ["housing", "essential"]
    }
  ],
  "changeHistory": [
    {
      "timestamp": "2024-01-15T10:30:00.000Z",
      "action": "item_added",
      "details": { "itemName": "rent", "value": 1200 },
      "comment": "Added monthly rent expense",
      "currency": "USD"
    }
  ]
}</code></pre>
                    </details>
                </div>
            </section>

            <!-- Budget Summary Section -->
            <section class="summary full-width">
                <h2>üí∞ Budget Summary</h2>
                <div class="summary-grid">
                    <div class="summary-item">
                        <span class="label">üìÖ Total Monthly Expenses:</span>
                        <span class="value" id="totalMonthly">$0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">üìä Total Annual Expenses:</span>
                        <span class="value" id="totalAnnual">$0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">ÔøΩ Annual Investment:</span>
                        <span class="value" id="totalInvestment">$0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">ÔøΩüíµ Remaining Annual Budget:</span>
                        <span class="value" id="remainingBudget">$0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">üéØ Budget Status:</span>
                        <span class="value" id="budgetStatus">-</span>
                    </div>
                </div>
            </section>

            <!-- Budget Indicators Section -->
            <section class="budget-indicators full-width">
                <h2>Budget Indicators</h2>
                <div class="indicators-grid">
                    <div class="indicator">
                        <h3>Daily</h3>
                        <div class="indicator-value" id="dailyMax">$0.00</div>
                        <small>Max per day</small>
                    </div>
                    <div class="indicator">
                        <h3>Weekly</h3>
                        <div class="indicator-value" id="weeklyMax">$0.00</div>
                        <small>Max per week</small>
                    </div>
                    <div class="indicator">
                        <h3>Monthly</h3>
                        <div class="indicator-value" id="monthlyMax">$0.00</div>
                        <small>Max per month</small>
                    </div>
                    <div class="indicator">
                        <h3>Yearly</h3>
                        <div class="indicator-value" id="yearlyMax">$0.00</div>
                        <small>Max per year</small>
                    </div>
                </div>
            </section>

            <!-- Charts Section -->
            <section class="charts full-width">
                <div class="section-header">
                    <h2>Budget Visualization</h2>
                    <button type="button" id="refreshChartsBtn" class="refresh-btn" onclick="budgetTracker.updateCharts()">üîÑ Refresh Charts</button>
                </div>
                <div class="charts-container">
                    <div class="chart-wrapper">
                        <canvas id="budgetChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="remainingChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Dynamic Charts Section -->
            <section class="dynamic-charts full-width">
                <div class="section-header">
                    <h2>Custom Charts</h2>
                    <button type="button" id="refreshDynamicChartsBtn" class="refresh-btn" onclick="budgetTracker.refreshDynamicCharts()">üîÑ Refresh Custom Charts</button>
                </div>
                <p>Create custom pie charts to analyze your budget by specific tags, frequencies, or combinations.</p>
                
                <div class="chart-controls">
                    <div class="control-group">
                        <h3>Add New Chart</h3>
                        <div class="chart-options">
                            <div class="filter-option">
                                <label for="chartType">Chart Type:</label>
                                <select id="chartType">
                                    <option value="tag">By Tag</option>
                                    <option value="frequency">By Frequency</option>
                                    <option value="combined">Tag + Frequency</option>
                                </select>
                            </div>
                            
                            <div class="filter-option" id="tagFilterGroup">
                                <label for="tagChartSelect">Select Tag:</label>
                                <select id="tagChartSelect">
                                    <option value="" disabled selected>Choose tag</option>
                                    <option value="__all__">All Items</option>
                                </select>
                            </div>
                            
                            <div class="filter-option" id="freqFilterGroup" style="display: none;">
                                <label for="freqChartSelect">Select Frequency:</label>
                                <select id="freqChartSelect">
                                    <option value="" disabled selected>Choose frequency</option>
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                    <option value="yearly">Yearly</option>
                                </select>
                            </div>
                            
                            <div class="filter-option" id="combinedFilterGroup" style="display: none;">
                                <label for="combinedTagSelect">Tag:</label>
                                <select id="combinedTagSelect">
                                    <option value="" disabled selected>Choose tag</option>
                                    <option value="__all__">All Tags</option>
                                </select>
                                <label for="combinedFreqSelect">Frequency:</label>
                                <select id="combinedFreqSelect">
                                    <option value="" disabled selected>Choose frequency</option>
                                    <option value="__all__">All Frequencies</option>
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                    <option value="yearly">Yearly</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="chart-actions">
                            <button type="button" id="addCustomChartBtn" class="add-chart-btn">Add Chart</button>
                            <button type="button" id="clearAllChartsBtn" class="clear-charts-btn">Clear All Charts</button>
                        </div>
                    </div>
                </div>
                
                <div id="dynamicCharts" class="dynamic-charts-container">
                    <!-- Dynamic charts will be added here -->
                </div>
                
                <div class="no-charts-message" id="noChartsMessage">
                    <p>No custom charts created yet. Use the controls above to create your first chart!</p>
                </div>
            </section>

            <!-- Change History Section -->
            <section class="change-history full-width">
                <div class="section-header">
                    <h2>Change History</h2>
                    <button type="button" id="toggleHistoryBtn" class="refresh-btn" onclick="budgetTracker.toggleHistory()">üìã Show/Hide History</button>
                </div>
                <div id="historyContainer" class="history-container" style="display: none;">
                    <div class="history-filters">
                        <label for="historyActionFilter">Filter by Action:</label>
                        <select id="historyActionFilter" onchange="budgetTracker.filterHistory()">
                            <option value="">All Actions</option>
                            <option value="item_added">Items Added</option>
                            <option value="item_removed">Items Removed</option>
                            <option value="item_edited">Items Edited</option>
                            <option value="max_cash_updated">Budget Changes</option>
                            <option value="currency_changed">Currency Changes</option>
                            <option value="investment_value_changed">Investment Changes</option>
                            <option value="feed_imported">Feed Imports</option>
                        </select>
                        <button type="button" class="export-history-btn" onclick="budgetTracker.exportHistory()">Export History</button>
                        <button type="button" class="import-history-btn" onclick="budgetTracker.importHistory()">Import History</button>
                        <button type="button" class="clear-history-btn" onclick="budgetTracker.clearHistory()">Clear History</button>
                    </div>
                    <div class="history-list" id="historyList">
                        <!-- History entries will be displayed here -->
                    </div>
                </div>
            </section>

            <!-- Budget Items Section -->
            <section class="budget-items full-width">
                <h2>Budget Items</h2>
                <div class="add-item-form">
                    <div class="form-row">
                        <input type="text" id="itemName" placeholder="Item name" required>
                        <input type="number" id="itemValue" placeholder="Amount ($)" min="0" step="0.01" required>
                        <input type="text" id="itemTags" placeholder="Tags (optional)">
                        <select id="itemFrequency">
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly" selected>Monthly</option>
                            <option value="yearly">Yearly</option>
                        </select>
                        <button id="addItemBtn" onclick="addItem()">Add Item</button>
                    </div>
                </div>
                <div class="items-list" id="itemsList">
                    <!-- Items will be added here dynamically -->
                </div>
            </section>
        </main>

        <!-- Help Popup Modal -->
        <div id="helpModal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üí° Budget Planner - Help & Tips</h2>
                    <button type="button" class="close-btn" onclick="budgetTracker.closeHelpPopup()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="help-section">
                        <h3>üöÄ Getting Started</h3>
                        <ul>
                            <li><strong>Set Your Annual Budget:</strong> Enter your total available cash per year</li>
                            <li><strong>Choose Currency:</strong> Select your preferred currency (converts existing data automatically)</li>
                            <li><strong>Investment Allocation:</strong> Set aside money for investments (percentage or fixed amount)</li>
                            <li><strong>Add Budget Items:</strong> Create entries for rent, groceries, utilities, etc. with frequencies</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h3>üìä Using Budget Features</h3>
                        <ul>
                            <li><strong>Tags:</strong> Organize items with tags like "essential", "housing", "entertainment"</li>
                            <li><strong>Frequencies:</strong> Set items as daily, weekly, monthly, or yearly</li>
                            <li><strong>Custom Charts:</strong> Create visual breakdowns by tags or frequencies</li>
                            <li><strong>Budget Indicators:</strong> See your remaining budget per day/week/month/year</li>
                            <li><strong>Change History:</strong> Track all modifications with timestamps and comments</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h3>üíæ Data Management & Privacy</h3>
                        <div class="privacy-notice">
                            <p><strong>üîí Your Data Stays Yours:</strong> All budget data is stored locally in your browser. Nothing is sent to external servers.</p>
                        </div>
                        <ul>
                            <li><strong>Export Complete Data:</strong> Click "üì• Export Complete Data" to download everything (settings + items + history)</li>
                            <li><strong>Import Data:</strong> Use "Import Budget Data" to restore from a JSON file</li>
                            <li><strong>Backup Regularly:</strong> Export your data periodically to avoid loss</li>
                            <li><strong>Cross-Device Sync:</strong> Export from one device, import on another</li>
                            <li><strong>Version Control:</strong> Keep dated exports to track your budget evolution</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h3>üìà Analytics Features</h3>
                        <ul>
                            <li><strong>CSV Analytics:</strong> Upload bank transaction files for spending analysis</li>
                            <li><strong>Visual Charts:</strong> See spending patterns by description, type, and trends</li>
                            <li><strong>Advanced Filters:</strong> Filter transactions by date, amount, type, and description</li>
                            <li><strong>Data Grid:</strong> Professional table view with sorting and filtering</li>
                            <li><strong>Export Filtered:</strong> Download filtered transaction data</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h3>üí° Pro Tips</h3>
                        <ul>
                            <li><strong>Start Simple:</strong> Begin with major expenses (rent, groceries, utilities)</li>
                            <li><strong>Use Meaningful Tags:</strong> Group similar expenses for better insights</li>
                            <li><strong>Review Regularly:</strong> Check your budget monthly and adjust as needed</li>
                            <li><strong>Emergency Fund:</strong> Keep some budget unallocated for unexpected expenses</li>
                            <li><strong>Export Before Changes:</strong> Back up data before major modifications</li>
                            <li><strong>Combine with Analytics:</strong> Use CSV analytics to validate your budget assumptions</li>
                        </ul>
                    </div>

                    <div class="help-section">
                        <h3>üîß Troubleshooting</h3>
                        <ul>
                            <li><strong>Data Missing?</strong> Check browser storage or import your latest export</li>
                            <li><strong>Import Errors?</strong> Ensure JSON file matches the expected format</li>
                            <li><strong>Charts Not Showing?</strong> Refresh the page or add some budget items</li>
                            <li><strong>Currency Issues?</strong> Currency changes convert all existing values automatically</li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="modal-btn primary" onclick="budgetTracker.closeHelpPopup()">Got it!</button>
                    <button type="button" class="modal-btn secondary" onclick="budgetTracker.exportCompleteData()">üì• Export My Data Now</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>